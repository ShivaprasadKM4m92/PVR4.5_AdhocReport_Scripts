//# sourceMappingURL=dashboard.js.map
$(function(){function e(){if(isEditable){var a=_.map($(".grid-stack > .grid-stack-item:visible"),function(a){a=$(a);a=a.data("_gridstack_node");return{id:a.id,x:a.x,y:a.y,width:a.width,height:a.height}},this);$.ajax({type:"POST",url:CONFIGURATION.updateWidgetsUrl,dataType:"json",data:{items:JSON.stringify(a,null,"    "),id:$("#dashboardId").val()},error:function(a){console.log(a)}})}}function d(a){$.ajax({type:"GET",url:CONFIGURATION.getChartDataUrl,dataType:"json",data:{widgetId:a.data("widgetId"),
id:$("#dashboardId").val()},converters:{"text json":function(a){return JSON.parse(a,function(a,b){"formatter"===a&&(b=eval("("+b+")"));return b})}},error:function(a){console.log("Error on "+CONFIGURATION.getChartDataUrl);console.log(a)},success:function(b){a.find(".highcharts-container").show();a.highcharts(b.options);a.data("widgetTitle",b.title);a.append("<div style='width: 100%;text-align: right;' class='chartRunDate'>"+$.i18n._("app.dashboard.generated.label")+" "+b.runDate+"</div>");a.highcharts().setSize(a.innerWidth()-
25,a.innerHeight()-20)}})}$(".remove-widget").click(function(){if(isEditable){var a=$(this).closest(".grid-stack-item"),b=$(this).data("url"),c=$(this).data("params");c.id=$("#dashboardId").val();CONFIGURATION[b]&&$.ajax({type:"POST",url:CONFIGURATION[b],dataType:"json",data:c,error:function(a){console.log(a)},success:function(b){$(".grid-stack").data("gridstack").removeWidget(a)}})}});$(".rx-widget-menu-content").menu({select:function(a,b){isEditable&&(a=b.item.data("url"),b=b.item.data("params"),
CONFIGURATION[a]&&(b.id=$("#dashboardId").val(),window.location.href=CONFIGURATION[a]+"?"+$.param(b)))}});$(".grid-stack").gridstack({width:12,resizable:{autoHide:!0,handles:"all"},verticalMargin:10,draggable:{handle:".rx-widget-header"}});$(".grid-stack").on("change",function(a,b){b&&(e(),$(".widget-calendar").each(function(){var a=$(this);a.fullCalendar("option","contentHeight",a.parent().height()-150)}),$(".chart-container").each(function(){var a=$(this);a.highcharts().setSize(a.innerWidth()-25,
a.innerHeight()-20)}),$(".quality-chart-container").each(function(){var a=$(this);a.highcharts().setSize(a.innerWidth(),a.innerHeight()-25)}))});$(".chart-container").each(function(a,b){a=$(this);d(a)});$(".chart-container").on("pushNotification",function(a,b){a=$(this);var c=a.data("widgetTitle");if(b&&b.message&&-1<b.message.indexOf(c))return d(a),!1});$(document).on("click",".dashboardSummaryContent",function(){var a;$(this).hasClass("reportRequestSummary")&&(a=reportRequestIndexPage);$(this).hasClass("actionItemSummary")&&
(a=actonItemIndexPage);$(this).hasClass("aggregateSummary")&&(a=aggregateExecutedIndexPage);$(this).hasClass("adhocSummary")&&(a=adhocExecutedIndexPage);document.location.href=a});$(document).on("click",".editTitle",function(){$(".page-title").focus()});$(document).on("blur",".page-title",function(){isEditable&&$.ajax({type:"GET",url:updateLabelUrl+"?id="+$("#dashboardId").val()+"&label="+$(".page-title").text(),error:function(a){console.log("Error on "+CONFIGURATION.getChartDataUrl);console.log(a)},
success:function(a){}})});$(document).on("keydown",".page-title",function(a){13==a.keyCode&&(a.preventDefault(),$(".page-title").blur())})});