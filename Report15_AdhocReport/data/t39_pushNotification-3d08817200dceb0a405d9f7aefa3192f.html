//# sourceMappingURL=pushNotification.js.map
var $notificationContainer,notificationCount=0,$notificationRows,$notificationHeader,N_LEVEL_INFO_NAME="Information",N_LEVEL_WARN_NAME="Warning",N_LEVEL_ERROR_NAME="Error",INDEX="index",SHOW="show",PREVIEW="Preview of",userNotificationSubscribe=function(){var a=new SockJS(notificationWSURL),b=Stomp.over(a);b.connect({},function(){b.subscribe(notificationChannel,function(a){a=a.body;"X"!=a&&(a=JSON.parse(a),""!=a&&a.id&&(addNotification($notificationRows,a),setNotificationCount(notificationCount+1),
triggerNotificationEvent(a)))})})};
$(document).ready(function(){refershNotifications();$notificationContainer=$("#notificationContainer");$notificationRows=$("#notificationRows");$notificationHeader=$("#notificationHeader");$(document).on("click","#menuNotification",function(){$notificationContainer.is(":visible")?$notificationContainer.hide():$notificationContainer.show()});$(document).on("click","#notificationContainer",function(){event.preventDefault();return!1});$(document).on("click","#clearNotifications",function(){0<notificationCount&&
($.post(notificationDeleteByUserURL,{id:$(this).attr("userId")},function(a){},"text"),$notificationRows.empty(),setNotificationCount(0));return!1});$(document).on("click","#notificationRows a",function(){var a=$(this),b=$(a).attr("executedConfigId"),c=$(a).attr("executionStatusId"),h=0<$(a).find(".noti-danger").size(),e=$(a).attr("appName"),d=$(a).text().indexOf(PREVIEW),f=window.location.pathname.substring(0,window.location.pathname.indexOf("/",2));if(h)a=$(a).attr("notificationid"),window.location.href=
viewNotificationErrorURL+"/"+a;else return 1==d?window.location.href=f+"/caseList/index?cid="+c:"undefined"!=typeof e&&e&&"actionItem"===e?window.location.href=f+"/actionItem/index?id="+c:"undefined"!=typeof e&&e&&"caseSeries"===e?window.location.href=f+"/caseList/index?cid="+c:"undefined"!=typeof e&&e&&"reportRequest"===e?window.location.href=f+"/reportRequest/show?id="+c:b&&!h&&(window.location.href=reportRedirectURL+"/"+b),!1});$(document).on("click",".removeNotification",function(){var a=$(this).closest("a");
$.post(notificationDeleteURL,{id:$(a).attr("notificationId")},function(a){},"text");$(a).remove();--notificationCount;setNotificationCount(notificationCount);return!1});userNotificationSubscribe()});
function refershNotifications(){$.ajax({url:notificationURL,cache:!1,success:function(a){$notificationRows.empty();a.sort(function(a,c){return(new Date(a.dateCreated)).getTime()-(new Date(c.dateCreated)).getTime()});0<a.length&&$.each(a,function(){addNotification($notificationRows,this)});setNotificationCount(a.length)},dataType:"json"})}
function addNotification(a,b){var c=document.createElement("a");c.classList.add("list-group-item");c.setAttribute("notificationId",b.id);c.setAttribute("href","#");b.executedConfigId&&0<b.executedConfigId&&c.setAttribute("executedConfigId",b.executedConfigId);b.appName&&c.setAttribute("appName",b.appName);b.executionStatusId&&c.setAttribute("executionStatusId",b.executionStatusId);var h=document.createElement("div");h.classList.add("media");var e=document.createElement("div");e.classList.add("pull-left",
"p-r-10");var d=document.createElement("em");d.classList.add("fa");b.level===N_LEVEL_INFO_NAME?(d.classList.add("noti-success"),d.classList.add("fa-envelope")):b.level===N_LEVEL_WARN_NAME?(d.classList.add("noti-warning"),d.classList.add("fa-warning")):b.level===N_LEVEL_ERROR_NAME&&(d.classList.add("noti-danger"),d.classList.add("fa-minus-circle"));e.appendChild(d);d=document.createElement("div");d.classList.add("media-body");var f=document.createElement("h5");f.classList.add("media-heading");f.appendChild(document.createTextNode(b.message));
var g=document.createElement("p");g.classList.add("m-0");var k=document.createElement("span");k.classList.add("small");k.classList.add("italic");b=moment.utc(b.dateCreated).tz(userTimeZone).fromNow();b=document.createTextNode(b);k.appendChild(b);g.appendChild(k);d.appendChild(f);d.appendChild(g);f=document.createElement("div");f.classList.add("pull-right");g=document.createElement("em");g.classList.add("fa");g.classList.add("fa-times");g.classList.add("fa-lg");g.classList.add("removeNotification");
f.appendChild(g);h.appendChild(e);h.appendChild(d);h.appendChild(f);c.appendChild(h);a.prepend(c)}function setNotificationCount(a){notificationCount=a;$("#notificationBadge").text(a);1==a?$notificationHeader.text($.i18n._("notificationEndOne",a)):$notificationHeader.text($.i18n._("notificationEndMultiple",a))}function triggerNotificationEvent(a){$(".chart-container").trigger("pushNotification",a)};